{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html data-wf-domain="humanelydigi.webflow.io" data-wf-page="60ec4bfb5015ffe0e33bd460" data-wf-site="60ec4bfb5015ff27b83bd45f" data-wf-status="1" class="w-mod-js w-mod-ix wf-cormorant-n4-active wf-cormorant-n5-active wf-gothica1-n3-active js-focus-visible wf-cormorant-n3-active wf-cormorant-i3-active wf-cormorant-i4-active wf-cormorant-i5-active wf-cormorant-n6-active wf-cormorant-i6-active wf-cormorant-n7-active wf-cormorant-i7-active wf-gothica1-n1-active wf-gothica1-n2-active wf-gothica1-n4-active wf-gothica1-n5-active wf-gothica1-n6-active wf-gothica1-n7-active wf-gothica1-n8-active wf-gothica1-n9-active wf-active" data-js-focus-visible="">
    <head>
        
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <title>The Rise</title>
        <link rel="shortcut icon" href="{% static 'favicon/favicon.ico' %}"/>
        <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon/apple-touch-icon.png' %}">
        <link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicon/favicon-32x32.png' %}">
        <link rel="icon" type="image/png" sizes="16x16" href="{% static 'favicon/favicon-16x16.png' %}">
        <link rel="manifest" href="{% static 'favicon/site.webmanifest' %}">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <meta content="Webflow" name="generator">

        <style>.wf-force-outline-none[tabindex="-1"]:focus{outline:none;}</style>
        <style type="text/css">
            @font-face {
            font-weight: 400;
            font-style:  normal;
            font-family: 'Circular-Loom';

            src: url('https://cdn.loom.com/assets/fonts/circular/CircularXXWeb-Book-cd7d2bcec649b1243839a15d5eb8f0a3.woff2') format('woff2');
            }

            @font-face {
            font-weight: 500;
            font-style:  normal;
            font-family: 'Circular-Loom';

            src: url('https://cdn.loom.com/assets/fonts/circular/CircularXXWeb-Medium-d74eac43c78bd5852478998ce63dceb3.woff2') format('woff2');
            }

            @font-face {
            font-weight: 700;
            font-style:  normal;
            font-family: 'Circular-Loom';

            src: url('https://cdn.loom.com/assets/fonts/circular/CircularXXWeb-Bold-83b8ceaf77f49c7cffa44107561909e4.woff2') format('woff2');
            }

            @font-face {
            font-weight: 900;
            font-style:  normal;
            font-family: 'Circular-Loom';

            src: url('https://cdn.loom.com/assets/fonts/circular/CircularXXWeb-Black-bf067ecb8aa777ceb6df7d72226febca.woff2') format('woff2');
            }
        </style>
        <link href = "{% static 'css/style.css' %}" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href= "{% static 'css/css' %}" media="all">
        
        <script src = "{% static 'js/webfont.js' %}" type="text/javascript"></script>      
        <script type="text/javascript">WebFont.load({  google: {    families: ["Cormorant:300,300italic,regular,italic,500,500italic,600,600italic,700,700italic", "Gothic A1:200,300,regular,500,600,700,800,900"]  }});</script>
        <!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]-->
        <script type="text/javascript">
            !function(o,c){var n=c.documentElement,t=" w-mod-";
            n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);
        </script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/amplitudejs@5.3.2/dist/amplitude.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
    </head>
    <body class="body">
        <div class="nav">
            <a href="https://therise.online/logout" id = "logo_link"><img src="{% static 'img/logo_white.png' %}" alt="white the rise logo" id = "banner_logo"></a>
            <a href="https://therise.online/my_profile" class="profile_banner_link_block w-inline-block">
                {% if logged_user.profile_picture %}
                <img src="{{logged_user.profile_picture.url}}" loading="lazy" width="113" alt="placeholder profile picture" class="profile_thumbnail">
                {% else %}
                <img src="{% static '/img/globe.png' %}" loading="lazy" width="113" alt="placeholder profile picture" class="profile_thumbnail">
                {% endif %}
                <h1 class="profile_banner">{{logged_user.first_name}} {{logged_user.last_name}}</h1>
            </a>
        </div>
        <div class="network_block">
            <a href="https://therise.online/home" class="network_link_block w-inline-block">
                <h1 data-w-id="ee46b548-7cad-c835-5ba7-fee04a006c78" class="network_heading public">Boston College</h1>
            </a>

        </div>
        <div class="main_block">
            <div class="public_panel">
                <div class="main_banner">
                    <div  class="search_space_block">
                        <form id="space_search_form" name="space_search_form" class="search_form" method = "POST" action = "https://therise.online/process_space_search">
                            {% csrf_token %}
                            <input type="text" class="search_text_field w-input" maxlength="256" name="space_query" placeholder="Search" id="space_search_input">
                            <img src="{% static 'img/blue_plus.svg' %}" loading="lazy" alt="blue x symbol icon" class="sidebar sidebar_close_small">
                        </form>
                    </div>
                    <div class="main_banner_block discussion_banner">
                        <div class="main_banner_block_left w-clearfix">
                            <h2 class="space_header">{{current_space.name}}</h2>
                            <a href="https://therise.online/favorite_space/{{current_space.id}}" {% if current_space in favorite_spaces %} data-active = "favorited" {% else %}data-active = "unfavorited"{% endif %} class="favorite_button w-inline-block">
                                {% if current_space in favorite_spaces %}
                                <img src="{% static 'img/filled_star.svg' %}" loading="lazy" width="22" alt="star icon" class="star">
                                {% else %}
                                <img src="{% static 'img/star.svg' %}" loading="lazy" width="22" alt="star icon" class="star">
                                {% endif %}
                            </a>
                        </div>
                    </div>
                    <div class="main_banner_block response_banner player w-clearfix">
                        <a href="https://therise.online/home" class="back_arrow_link_block w-inline-block">
                            <img src="{% static 'img/arrow.svg' %}" loading="lazy" data-w-id="7c90edb3-18b8-7a8f-86fe-52c6ca6c0385" alt="white arrow icon" class="arrow">
                        </a>
                        {% if current_discussion != -1%}
                        <img src="{{current_discussion.poster.profile_picture.url}}" loading="lazy" width="60" alt="placeholder profile picture" class="album_art album_art_banner">
                        <div class="response_banner_middle player">
                            <h1 class="song-title banner_song_title">{{current_discussion.title}}</h1>
                            <h2 class="song-artist banner_song_artist">{{current_discussion.poster.first_name}} {{current_discussion.poster.last_name}}</h2>
                            <progress class="amplitude-song-played-progress progress-{{current_discussion_index}}-0" data-amplitude-song-index="0" data-amplitude-playlist="{{current_discussion_index}}"></progress>
                            <h3 class="current-time current-time-{{current_discussion_index}}-0" style = "display:none;">
                                <span class="amplitude-current-minutes" data-amplitude-song-index="0" data-amplitude-playlist="{{current_discussion_index}}"></span>:<span class="amplitude-current-seconds" data-amplitude-song-index="0" data-amplitude-playlist="{{current_discussion_index}}"></span>
                            </h3>
                            <h3 class="duration banner_duration duration-{{current_discussion_index}}-0" >{{current_discussion.duration}}</h3>
                            <a href="{{current_discussion.link}}" class="discussion_link response_banner_link">{{current_discussion.link_title}}</a>
                        </div>
                        <div class="reponse_banner_right w-clearfix">
                            <h4 class="time_posted">{{current_discussion.created_at|naturaltime}}</h4>
                            <div class=" amplitude-play-pause response_banner_play amplitude-paused"  data-amplitude-song-index="0" data-amplitude-playlist="{{current_discussion_index}}">
                                <img src="{% static 'img/blue_play.svg' %}" loading="lazy" width="15" alt="blue play button" class="play banner_play play-{{current_discussion_index}}-0">
                                <img src="{% static 'img/blue_pause.svg' %}" loading="lazy" width="15" alt="blue pause button" class="pause banner_pause pause-{{current_discussion_index}}-0">
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    <div class="main_banner_block post_discussion_banner">
                        <div class="post_discussion_title_form">
                            <form id="discussion_title_form" name="discussion_title_form" class="discussion_title_form">
                                <input type="text" class="discussion_title_text_field w-input" maxlength="256" name="discussion_title" placeholder="Title your discussion" id="discussion_title">
                            </form>
                        </div>
                    </div>
                </div>
                <div class="main_body">
                    <div class="spaces_block">
                        <div class="favorite_spaces_block">
                            <h1 class="spaces_heading">Favorite Spaces</h1>
                            <div class="favorite_spaces">
                                {% for space in favorite_spaces %}
                                <a href="https://therise.online/{{space.network.id}}/{{space.id}}" class="space_heading sidebar_close_small">{{space.name}}</a>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="all_spaces_block">
                            <h1 class="spaces_heading">All Spaces</h1>
                            <div class="all_spaces">
                                {% for space in spaces %}
                                <a href="https://therise.online/{{space.network.id}}/{{space.id}}" class="space_heading sidebar_close_small">{{space.name}}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="discussions_block w-clearfix">
                        <div class="discussion_button_block">
                            <a href="https://therise.online/{{current_space.id}}/top" class="discussion_tab_button w-button">Top</a>
                            <a href="https://therise.online/{{current_space.id}}/recent" class="discussion_tab_button selected_discussion_button w-button">Recent</a>
                            <a href="https://therise.online/{{current_space.id}}/saved" class="discussion_tab_button saved_button w-button">Saved</a>
                        </div>
                        <div class="discussion_posts_block">
                            {% for discussion in discussions %}
                            {% with user=discussion.poster %}
                            <div class="discussion_post" >
                                <div class="discussion player">
                                    <div class="discussion_top">
                                        <img src="{{user.profile_picture.url}}" loading="lazy" width="60" alt="{{user.first_name}} {{user.last_name}}'s profile picture" class="album_art">
                                        <div class="discussion_top_middle" data-discussion-id = "{{discussion.id}}" data-discussion-index = "{{forloop.counter0}}">
                                            <h2 class="song-artist">{{user.first_name}} {{user.last_name}}</h2>
                                            <progress class="amplitude-song-played-progress progress-{{forloop.counter0}}-0" data-amplitude-song-index="0" data-amplitude-playlist = "{{forloop.counter0}}"></progress>
                                            <h3 class="current-time current-time-{{forloop.counter0}}-0" style = "display:none;">
                                                <span class="amplitude-current-minutes" data-amplitude-song-index="0" data-amplitude-playlist="{{forloop.counter0}}"></span>:<span class="amplitude-current-seconds" data-amplitude-song-index="0" data-amplitude-playlist="{{forloop.counter0}}"></span>
                                            </h3>
                                            <h3 class="duration duration-{{forloop.counter0}}-0">{{discussion.duration}}</h3>
                                        </div>
                                        <div class="discussion_top_right w-clearfix">
                                            <h4 class="time_posted">{{discussion.created_at|naturaltime}}</h4>
                                            <div class=" amplitude-play-pause "  data-amplitude-song-index="0" data-amplitude-playlist="{{forloop.counter0}}">
                                                <img src="{% static 'img/blue_play.svg' %}" loading="lazy" width="15" alt="blue play button" class="play play-{{forloop.counter0}}-0">
                                                <img src="{% static 'img/blue_pause.svg' %}" loading="lazy" width="15" alt="blue pause button" class="pause pause-{{forloop.counter0}}-0" style = "display:none;">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="discussion_bottom" data-discussion-id = "{{discussion.id}}" data-discussion-index = "{{forloop.counter0}}">
                                        <h1 class="song-title">{{discussion.title}}</h1>
                                        <a href="{{discussion.link}}" class="discussion_link">{{discussion.link_title}}</a>
                                    </div>
                                </div>
                                <div class="discussion_buttons">
                                    <div class="participant_cap">
                                        <h2 class="cap_heading">{{discussion.participant_count}}/{{discussion.participant_cap}}</h2>
                                        <img src="{% static 'img/filled_person.svg' %}" loading="lazy" width="11" alt="blue person icon" class="person">
                                    </div>
                                    <a href="https://therise.online/save_discussion/{{discussion.id}}" class="bookmark_link_block w-inline-block" {% if discussion in user.saved_discussions %} data-active = "saved" {% else %} data-active = "unsaved" {% endif %}>
                                        {% if discussion in user.saved_discussions.all %}
                                        <img src="{% static 'img/filled_bookmark.svg' %}" loading="lazy" width="30" alt="blue bookmark icon" class="bookmark">
                                        {% else %}
                                        <img src="{% static 'img/empty_bookmark.svg' %}" loading="lazy" width="30" alt="blue bookmark icon" class="bookmark">
                                        {% endif %}
                                    </a>
                                </div>
                            </div>
                            {% endwith %}
                            {% endfor %}
                        </div>
                        <a  class="plus_discussion_button w-inline-block" id = "plus_discussion_button_big">
                            <img src="{% static 'img/cyan_plus.svg' %}" loading="lazy" alt="cyan plus icon" class="plus">
                        </a>
                        <a class="plus_discussion_button small w-inline-block" id = "plus_discussion_button_small">
                            <img src="{% static 'img/cyan_plus.svg' %}" loading="lazy" alt="cyan plus icon" class="plus">
                        </a>
                    </div>
                    <div class="responses_block">
                        <div class="response_posts_block">
                            {% for response in current_discussion.response_posts.all %}
                            <div class="response_post">
                                <div class="response player">
                                    <img src="{{ response.poster.profile_picture.url}}" loading="lazy" width="60" alt= "profile picture" class="album_art">
                                    <div class="response_middle">
                                        <h3 class="song-artist response_text">{{response.poster.first_name}} {{response.poster.last_name}}</h3>
                                        <progress class="amplitude-song-played-progress response_progress progress-{{current_discussion_index}}-{{forloop.counter}}" data-amplitude-song-index="{{forloop.counter}}" data-amplitude-playlist="{{current_discussion_index}}" ></progress>
                                        <h4 class="response-current-time response-text current-time-{{current_discussion_index}}-{{forloop.counter}} " style = "display:none;">
                                            <span class="amplitude-current-minutes response_text" data-amplitude-song-index="{{forloop.counter}}" data-amplitude-playlist="{{current_discussion_index}}"></span>:<span class="amplitude-current-seconds response_text" data-amplitude-song-index="{{forloop.counter}}" data-amplitude-playlist="{{current_discussion_index}}"></span>
                                        </h3>
                                        <h4 class="response-duration response-text duration-{{current_discussion_index}}-{{forloop.counter}} ">{{response.duration}}</h3>
                                    </div>
                                    <div class="reponse_banner_right w-clearfix">
                                        <h5 class="time_posted response_text">{{response.created_at|naturaltime}}</h5>
                                        <div class="amplitude-play-pause amplitude-paused response_play" data-amplitude-song-index="{{forloop.counter}}" data-amplitude-playlist="{{current_discussion_index}}">
                                            <img src="{% static 'img/cyan_play.svg' %}" loading="lazy" width="15" alt="cyan play button" class="play play_response play-{{current_discussion_index}}-{{forloop.counter}}">
                                            <img src="{% static 'img/cyan_pause.svg' %}" loading="lazy" width="15" alt="cyan pause button" class="pause pause-{{current_discussion_index}}-{{forloop.counter}}" style = "display:none;">
                                        </div>
                                    </div>
                                    {% if response.link %}
                                    <div class="discussion_bottom">
                                        <a href="{{response.link}}" class="discussion_link">{{response.link_title}}</a>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        {% if current_discussion != -1 %}
                        <a class="plus_response_button w-inline-block" id = "plus_response_button_big">
                            <img src="{% static 'img/blue_plus.svg' %}" loading="lazy" alt="blue plus symbol icon" class="plus">
                        </a>
                        <a class="plus_response_button small w-inline-block" id = "plus_response_button_small">
                            <img src="{% static 'img/blue_plus.svg' %}" loading="lazy" alt="blue plus symbol icon" class="plus">
                        </a>
                        {% endif %}
                    </div>
                    <div class="discussion_form_block" id = "discussion_form_block">
                        <div class="post_discussion_block" id = "post_discussion_block">
                            <form id="discussion_form" name="discussion_form" class="discussion_form" method = "POST" action = "https://therise.online/process_discussion_post" enctype="multipart/form-data">
                                {% csrf_token %}
                                {% if messages %}
                                <ul class = "error_list">
                                    {% for message in messages %}
                                    <li class = "error_item">{{message}}</li>
                                    {% endfor %}
                                </ul>
                                {% endif %}
                                <input type="hidden" name = "title" id = "discussion_title_input">
                                <input type="hidden" name = "participant_cap" id = "discussion_participant_cap_input">
                                <label for="discussion_type" class="discussion_form_label">Discussion Type</label>
                                <div class="radio_buttons_block">
                                    <a class="discussion_type_radio_button w-button" data-option = "2">2<img src="{% static 'img/filled_person.svg' %}" loading="lazy" alt="blue person icon" id = "filled_person_2" class="person_button"></a>
                                    <a class="discussion_type_radio_button w-button" data-option = "10">10<img src="{% static 'img/filled_person.svg' %}" loading="lazy" alt="blue person icon" id = "filled_person_10" class="person_button"></a>
                                    <a class="discussion_type_radio_button w-button" data-option = "100">100<img src="{% static 'img/filled_person.svg' %}" loading="lazy" alt="blue person icon" id = "filled_person_100" class="person_button"></a>
                                </div>
                                <label for="link" class="discussion_form_label">Supporting Link</label>
                                <div class="input_block">
                                    <img src="{% static 'img/link.svg' %}" loading="lazy" alt="blue link icon" class="image">
                                    <input type = "text" name = "link" class="link_input recording_input">
                                </div>
                                <label for="audio_recording" class="discussion_form_label">Voice Recording</label>
                                <div class="input_block">
                                    <a id = "record_discussion_button" class="microphone_block discussion_form_mic_button w-inline-block record_button">
                                        <img src="{% static 'img/mic.svg' %}" loading="lazy" width="37" alt="white microphone icon" class="mic">
                                        
                                    </a>
                                    <a id = "stop_discussion_button" class="microphone_block discussion_form_mic_button w-inline-block stop_button">
                                        <img src="{% static 'img/stop.svg' %}" loading="lazy" width="37" alt="white stop icon" class="mic">
                                    </a>
                                    <div class = "recording_input_bar recording_input" ><div class = "recording_input recording_progress" id = "recording_progress_dicussion"></div></div>
                                    <audio class="recording_input recorded_audio" id = "recorded_discussion_audio" controls = "true"></audio>
                                    <label class = "elapsed_duration_display" id = "discussion_elapsed_duration">00:00</label>
                                    <img src="{% static 'img/blue_plus.svg' %}" loading="lazy" alt="blue x symbol icon" class="sidebar sidebar_close_small clear_recording_button">
                                </div>
                                <input type="file"  accept="audio/*" name="audio_recording" class = "audio_input" id="discussion_audio_input">
                                <input type="hidden" name = "duration" class = "duration_input" id = "discussion_duration_input">
                            </form>
                        </div>
                        <a class="post_button_block post_discussion_button w-inline-block">
                            <h3 class="post_heading">Post</h3>
                        </a>
                        <a class="post_button_block post_discussion_button small w-inline-block">
                            <h3 class="post_heading">Post</h3>
                        </a>
                    </div>
                    <div class="discussion_form_block" id = "response_form_block">
                        <div class="post_discussion_block" id = "post_response_block">
                            <form id="response_form" name="response_form" class="discussion_form" method = "POST" action = "https://therise.online/process_response_post" enctype="multipart/form-data">
                                {% csrf_token %}
                                {% if messages %}
                                <ul class = "error_list">
                                    {% for message in messages %}
                                    <li class = "error_item">{{message}}</li>
                                    {% endfor %}
                                </ul>
                                {% endif %}
                                <label for="link" class="discussion_form_label">Supporting Link (Optional)</label>
                                <div class="input_block">
                                    <img src="{% static 'img/link.svg' %}" loading="lazy" alt="blue link icon" class="image">
                                    <input type = "text" name = "link" class="link_input recording_input">
                                </div>
                                <label for="audio_recording" class="discussion_form_label">Voice Recording</label>
                                <div class="input_block">
                                    <a id = "record_button" class="microphone_block discussion_form_mic_button w-inline-block record_button">
                                        <img src="{% static 'img/mic.svg' %}" loading="lazy" width="37" alt="white microphone icon" class="mic">
                                        
                                    </a>
                                    <a id = "stop_button" class="microphone_block discussion_form_mic_button w-inline-block stop_button">
                                        <img src="{% static 'img/stop.svg' %}" loading="lazy" width="37" alt="white stop icon" class="mic">
                                    </a>
                                    <div class = "recording_input_bar recording_input"><div class = "recording_input recording_progress" id = "recording_progress_response"></div></div>
                                    <audio class="recording_input recorded_audio" id = "recorded_response_audio" controls = "true"></audio>
                                    <label class = "elapsed_duration_display" id = "response_elapsed_duration">00:00</label>
                                    <img src="{% static 'img/blue_plus.svg' %}" loading="lazy" alt="blue x symbol icon" class="sidebar sidebar_close_small clear_recording_button" >
                                </div>
                                <input type="file"  accept="audio/*" name="audio_recording" class = "audio_input" id="response_audio_input">
                                <input type="hidden" name = "duration" class = "duration_input" id = "response_duration_input">
                            </form>
                        </div>
                        <a class="post_button_block post_response_button w-inline-block">
                            <h3 class="post_heading">Post</h3>
                        </a>
                        <a class="post_button_block post_response_button small w-inline-block">
                            <h3 class="post_heading">Post</h3>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <script src="{% static 'js/webflow.js' %}" type="text/javascript"></script>
        <!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
        <script src = "{% static 'js/home.js' %}" type="text/javascript"></script>  
        <script>
            var prevActiveIndex = -1;
            var prevActivePlaylist = -1;
            let songs = [];
            {% for discussion in discussions %}
            songs.push({
                "name": "{{discussion.title}}",
                "artist": "{{discussion.poster.first_name}} {{discussion.poster.last_name}}",
                "url": "{{discussion.audio.url}}",
                "element": document.createElement("audio"),
            });
            {% endfor %}
            var load_songs = function(){
                Amplitude.init({
                    "songs": songs,
                    playlists: {
                        {% for discussion in discussions %}
                        "{{forloop.counter0}}": {
                            songs: [{{forloop.counter0}},]
                        },
                        {% endfor %}
                    },
                    starting_playlist: "0",
                    starting_playlist_song: "0",
                    preload: "metadata",
                    callbacks: {
                        /**
                         * Function to handle the event of a song change
                         */
                        song_change: function(){
                            let activeID = Amplitude.getActiveSongMetadata().index;
                            let playlist_id = Amplitude.getActivePlaylist();
                        },
                        /**
                         * Function to handle the event of a song jumping to the next song
                         */
                        next:function(){
                            /**
                             * If we have reached the end of the playlist
                             */
                            if(Amplitude.getActiveSongMetadata().index == 0){
                                let id = Amplitude.getActiveSongMetadata().index;
                                let playlist = Amplitude.getActivePlaylist();
                                let current_song_element = ".duration-" +  playlist + "-" + id;
                                $(current_song_element).css("display", "flex");
                                current_song_element = ".current-time-" +  playlist + "-" + id;
                                $(current_song_element).css("display", "none");
                                current_song_element = ".play-" +  playlist + "-" + id;
                                $(current_song_element).css("display", "flex");
                                current_song_element = ".pause-" +  playlist + "-" + id;
                                $(current_song_element).css("display", "none");
                                prevActiveIndex = id;
                                prevActivePlaylist = Amplitude.getActivePlaylist();
                            }
                        },
                    }
                });
            };
        </script>
        <script type = "text/JavaScript">
            $(document).ready(function(){
                  
                try{
                    for(let i = 0; i < Amplitude.getActivePlaylistMetadata().songs.length; i++){
                        var song = Amplitude.getActivePlaylistMetadata().songs[i];
                        let playlist = Amplitude.getActivePlaylist();

                        let au = song.element;
                        au.src = song.url;
                        au.id = i;
                        au.preload = "none";
                        au.addEventListener('loadedmetadata', function(){
                            var duration = Math.floor(au.duration);
                            let mins = Math.floor(duration / 60); 
                            let secs = duration % 60;
                            secs = secs.toLocaleString('en-US', {
                                minimumIntegerDigits: 2,
                                useGrouping: false
                            })
                            let c = ".duration-" + playlist + "-" + i;
                            $(c).html(mins + ":" + secs);
                        },false);
                    }
                }catch(e){
                    console.log("No songs yet");
                }


                load_songs();


                $(document).on('submit', '#discussion_form', function() {
                    $('#discussion_title').val("");
                    let file_input = document.getElementById('discussion_audio_input');
                    let formData = new FormData(document.getElementById('discussion_form'));
                    $.ajax({
                        type: $(this).attr('method'),
                        url: $(this).attr('action'),
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            $('#post_discussion_block').html(data);
                            $('.clear_recording_button').click();
                            $.ajax({
                                type: 'GET',
                                url: "https://therise.online/{{current_space.network.id}}/{{current_space.id}}",
                                success: function (data) {
                                    $('.discussion_posts_block').html(data);
                                },
                                error: function(data) {
                                }
                            });
                        },
                        error: function(data) {
                        }
                    });
                    return false;
                });
                $(document).on('submit', '#response_form', function() {
                    let file_input = document.getElementById('response_audio_input');
                    let formData = new FormData(document.getElementById('response_form'));
                    $.ajax({
                        type: $(this).attr('method'),
                        url: $(this).attr('action'),
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            $('#post_response_block').html(data);
                            $('.clear_recording_button').click();
                            $.ajax({
                                type: 'GET',
                                url: "https://therise.online/{{current_space.network.id}}/{{current_space.id}}",
                                success: function (data) {
                                    $('.response_posts_block').html(data);
                                },
                                error: function(data) {
                                }
                            });
                        },
                        error: function(data) {
                        }
                    });
                    return false;
                });
            });
        </script>
    </body>
    <loom-container id="lo-engage-ext-container">
        <div></div>
        <loom-shadow classname="resolved"></loom-shadow>
    </loom-container>
</html>